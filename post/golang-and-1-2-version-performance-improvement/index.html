<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <meta content="Willian Molinari a.k.a. PotHix" name="author">
        <meta property="og:title" content="Golang and 1.2 version performance improvement - PotHix">
        <meta property="og:url" content="http://pothix.com/post/golang-and-1-2-version-performance-improvement/">
        <meta property="og:description" content="The personal website for Willian Molinari, also known as PotHix">
        <meta property="og:type" content="website" />
        <meta name="generator" content="Hugo 0.20.7" />

        <title>Golang and 1.2 version performance improvement | PotHix</title>

        
        <link rel="dns-prefetch" href="//fonts.googleapis.com">

        

        <link rel="alternate" type="application/atom+xml" title="Atom Feed (all posts)" href="http://feeds.feedburner.com/PotHix" />
        <link rel="alternate" type="application/atom+xml" title="Atom Feed (all posts in English)" href="http://feeds.feedburner.com/EnglishPotHix" />
        <link rel="alternate" type="application/atom+xml" title="Atom Feed (all posts related to technology)" href="http://feeds.feedburner.com/PotHixTech" />

        <link rel="icon" type="image/png" href="/images/favico.png">
        <link rel="stylesheet" href="/stylesheets/style.css" type="text/css" media="all" />
        <link rel="stylesheet" href="/stylesheets/stag-custom-styles.css" type="text/css" media="all" />

        <link rel="stylesheet" href="/stylesheets/font-awesome-4.3.0/css/font-awesome.min.css">
        <link rel="stylesheet" id="doctype-fonts-css"  href="http://fonts.googleapis.com/css?family=Rokkitt%3A700%7CLato%3A300%2C400%2C700%2C300italic&#038;subset=latin" type="text/css" media="all" />

        <body class="blog sticky-nav chrome stagtools">
            <div id="page" class="hfeed site">
                <header id="masthead" class="site-header site-header--fixed" role="banner">
                    <div class="inside">
                        <div id="navbar" class="navbar">
  <nav id="site-navigation" class="navigation main-navigation" role="navigation">
    <ul id="primary-menu" class="primary-menu">
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/">Home</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/coding">Coding</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/speaking">Speaking</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/writing">Writing</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/now">Now</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/about">About me</a>
      </li>
    </ul>
  </nav>
</div>

                        <a class="site-branding" href="/" title="Doctype" rel="home">
                            <span class="logo-container">
                                <img data-at2x src="/images/logo.png" alt="Website's logo">
                            </span>
                        </a>
                    </div>
                </header>


<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article class="post type-post status-publish format-standard has-post-thumbnail hentry category-wordpress tag-version tag-wordpress-2 mix">
         <header class="entry-header">
      	   <h2 class="entry-title">Golang and 1.2 version performance improvement</h2>
         </header>

         <div class="entry-meta">
          <span class="posted-on">
            Published at December 3, 2013
          </span>
          <span class="tags-links">
            
            <a href="/tags/golang">golang</a>,
            
            <a href="/tags/english">english</a>,
            
            <a href="/tags/tech">tech</a>,
            
          </span>
        </div>

        <div class="entry-content">
          <p>I&rsquo;ve started using Go last month and I really liked to work with the language.</p>

<p>The project I&rsquo;m working on is dead simple and just retrieves metrics and save on
a redis server (the data will be analyzed by a different project that I&rsquo;m
working on). So I have 15 goroutines retrieving data constantly and I&rsquo;m using
just two native threads.</p>

<p>I did some CPU profiling on the code using my current machine for Golang 1.1.2
and 1.2 and the results can be seen below.</p>

<p>Golang 1.1.2:</p>

<pre><code>    (pprof) top10
    Total: 188701 samples
    137454  72.8%   72.8%   137454  72.8% crypto/des.permuteBlock
    44032   23.3%   96.2%   169187  89.7% crypto/des.feistel
    3750    2.0%    98.2%   184544  97.8% crypto/des.cryptBlock
    823     0.4%    98.6%   185650  98.4% crypto/cipher.(*cbcDecrypter).CryptBlocks
    290     0.2%    98.8%      290   0.2% encoding/binary.bigEndian.PutUint64
    232     0.1%    98.9%      232   0.1% encoding/binary.bigEndian.Uint64
    227     0.1%    99.0%      227   0.1% crypto/sha1.block
    215     0.1%    99.1%      267   0.1% encoding/json.state1
    207     0.1%    99.2%      430   0.2% encoding/json.checkValid
    178     0.1%    99.3%      398   0.2% encoding/json.nextValue

    # top command result
    PID USER      PR  NI  VIRT    RES      SHR S  %CPU %MEM    TIME+  COMMAND
    18115 pothix    20   0  871800  67888   3932 S 188.8  1.7  12:40.08 crebain

    # A snapshot of the processors
    %Cpu0  :100.0 us,  0.0 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
    %Cpu1  : 95.0 us,  3.0 sy,  0.0 ni,  2.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</code></pre>

<p>Golang 1.2:</p>

<pre><code>    (pprof) top10
    Total: 6894 samples
    1686    24.5%   24.5%   1686    24.5%   crypto/aes.decryptBlockGo
    1299    18.8%   43.3%   3093    44.9%   crypto/cipher.(*cbcDecrypter).CryptBlocks
    471     6.8%    50.1%   1062    15.4%   encoding/json.checkValid
    420     6.1%    56.2%   541     7.8%    encoding/json.state1
    359     5.2%    61.4%   359     5.2%    crypto/sha1.block
    305     4.4%    65.9%   838     12.2%   encoding/json.nextValue
    245     3.6%    69.4%   274     4.0%    syscall.Syscall
    230     3.3%    72.7%   230     3.3%    encoding/json.stateBeginValue
    186     2.7%    75.4%   225     3.3%    encoding/json.stateEndValue
    156     2.3%    77.7%   156     2.3%    runtime.memmove

    top command result
    PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    20534 pothix    20   0  598428  51584   3532 S  12.9  1.3   0:03.76 crebain

    %Cpu0  : 12.1 us,  5.1 sy,  5.1 ni, 72.7 id,  5.1 wa,  0.0 hi,  0.0 si,  0.0 st
    %Cpu1  : 20.0 us,  4.0 sy,  0.0 ni, 75.0 id,  1.0 wa,  0.0 hi,  0.0 si,  0.0 st
</code></pre>

<p>What an improvement! :)</p>

<p>I know that this application may not be the best example to compare Go with a
different language because it depends of a third application (that is my
bottleneck BTW) and Ruby perform as good as the new version but I really liked
to give Go a try.</p>

<p>Go language has a lot of interesting ideas and it is growing fast.
Looks like it is a good idea of language for some of my projects, welcome Golang!</p>

          
<div id="disqus_thread"></div>
<script type="text/javascript">
     
    var disqus_shortname = 'pothixcom';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


        </div>
      </article>
    </main>
  </div>
</div>

        <footer class="footer-widget-area">
            <div class="inside">
                <div class="grids">
                    <aside id="stag-dribbble-2" class="widget grid-4 stag-dribbble">
                        <div>
                            
                            <h3 class="widget-title">
                                <span>Photography, a hobby</span>
                            </h3>
                            <style type="text/css">
                                .flickrimg {border: 1px solid #666666 !important; padding:1px; margin:2px;}
                                #flickr_badge_wrapper {width:366px;text-align:left}
                            </style>
                            <div id="flickr_badge_wrapper">
                                <script type="text/javascript" src="http://www.flickr.com/badge_code.gne?count=12&display=random&size=square&nsid=11054795@N06&raw=1"></script>
                            </div>
                        </div>
                    </aside>

                    <aside id="recent-posts-2" class="widget grid-4 widget_recent_entries">
                        <h3 class="widget-title">
                            <span>Books I'm reading</span>
                        </h3>

                        <ul>
                            <style type="text/css" media="screen">
                                .gr_grid_container {
                                 
                                    height:150px;
                                }

                                .gr_grid_book_container {
                                    float: left;
                                    width: 98px;
                                    height: 160px;
                                    padding: 0px 0px;
                                    overflow: hidden;
                                }
                            </style>

                            <div id="gr_grid_widget_1490660444">
                                
                                <div class="gr_grid_container">
                                    <div class="gr_grid_book_container"><a title="Elixir in Action" href="https://www.goodreads.com/book/show/20524444-elixir-in-action"><img alt="Elixir in Action" border="0" src="https://images.gr-assets.com/books/1389595057m/20524444.jpg" /></a></div>
                                    <div class="gr_grid_book_container"><a title="Mindfulness in Plain English" href="https://www.goodreads.com/book/show/64369.Mindfulness_in_Plain_English"><img alt="Mindfulness in Plain English" border="0" src="https://images.gr-assets.com/books/1385189327m/64369.jpg" /></a></div>
                                    <div class="gr_grid_book_container"><a title="The Art of The Lord of the Rings by J.R.R. Tolkien" href="https://www.goodreads.com/book/show/24886320-the-art-of-the-lord-of-the-rings-by-j-r-r-tolkien"><img alt="The Art of The Lord of the Rings by J.R.R. Tolkien" border="0" src="https://images.gr-assets.com/books/1442825644m/24886320.jpg" /></a></div>
                                    <noscript><br/>Share <a href="/">book reviews</a> and ratings with Willian, and even join a <a href="/group">book club</a> on Goodreads.</noscript>
                                </div>
                            </div>
                            <script src="https://www.goodreads.com/review/grid_widget/38970458.Willian's%20currently-reading%20book%20montage?cover_size=medium&hide_link=true&hide_title=true&num_books=6&order=a&shelf=currently-reading&sort=date_added&widget_id=1490660444" type="text/javascript" charset="utf-8"></script>
                        </ul>
                    </aside>

                    <aside id="text-2" class="widget grid-4 widget_text">
                        <h3 class="widget-title">
                            <span>Follow this blog</span>
                        </h3>
                        <div class="textwidget">
                            I've added three different RSS feeds here based on categories. The idea was to help you the tech guy that don't want to see what kind of motorcycle I have, or the english speaker that don't want to see portuguese posts on his feed reader.
                            <br /><br />
                            So, I have a feed for <a href="http://feeds.feedburner.com/PotHix">all my posts</a>, for the <a href="http://feeds.feedburner.com/EnglishPotHix">English posts</a> and <a href="http://feeds.feedburner.com/PotHixTech">Tech related posts</a>. Choose one and be happy! :)
                        </div>
                    </aside>
                </div>
            </div>
        </footer>

        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="site-info">
                <div class="grids">
                    <div class="grid-6">
                        © 2017 <a href="http://demo.codestag.com/doctype/">Doctype</a> WordPress Theme by <a href="//codestag.com">Codestag</a> modified by PotHix.
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script type='text/javascript' src='/javascripts/jquery.js'></script>
    <script type='text/javascript' src='/javascripts/widget.min.js'></script>
    <script type='text/javascript' src='/javascripts/tabs.min.js'></script>
    <script type='text/javascript' src='/javascripts/jquery.custom.js'></script>
    <script type='text/javascript' src='/javascripts/plugins.js'></script>
    <script type='text/javascript' src='/javascripts/jquery.mixitup.min.js'></script>

    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-2852094-2', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>


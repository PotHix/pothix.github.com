<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <meta content="Willian Molinari a.k.a. PotHix" name="author">
        <meta property="og:title" content="Assembling an Iris Rev4 - PotHix">
        <meta property="og:url" content="https://pothix.com/post/assembling-an-iris-rev4/">
        <meta property="og:description" content="The personal website for Willian Molinari, also known as PotHix">
        <meta property="og:type" content="website" />
        <meta name="generator" content="Hugo 0.73.0" />

        <title>Assembling an Iris Rev4 | PotHix</title>

        
        <link rel="dns-prefetch" href="//fonts.googleapis.com">

        

        <link rel="alternate" type="application/atom+xml" title="Atom Feed (all posts)" href="http://feeds.feedburner.com/PotHix" />
        <link rel="alternate" type="application/atom+xml" title="Atom Feed (all posts in English)" href="http://feeds.feedburner.com/EnglishPotHix" />
        <link rel="alternate" type="application/atom+xml" title="Atom Feed (all posts related to technology)" href="http://feeds.feedburner.com/PotHixTech" />

        <link rel="icon" type="image/png" href="/images/favico.png">
        <link rel="stylesheet" href="/stylesheets/style.css" type="text/css" media="all" />
        <link rel="stylesheet" href="/stylesheets/stag-custom-styles.css" type="text/css" media="all" />

        <link rel="stylesheet" href="/stylesheets/font-awesome-4.3.0/css/font-awesome.min.css">
        <link rel="stylesheet" id="doctype-fonts-css"  href="http://fonts.googleapis.com/css?family=Rokkitt%3A700%7CLato%3A300%2C400%2C700%2C300italic&#038;subset=latin" type="text/css" media="all" />

        <body class="blog sticky-nav chrome stagtools">
            <div id="page" class="hfeed site">
                <header id="masthead" class="site-header site-header--fixed" role="banner">
                    <div class="inside">
                        <div id="navbar" class="navbar">
  <nav id="site-navigation" class="navigation main-navigation" role="navigation">
    <ul id="primary-menu" class="primary-menu">
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/">Home</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/coding">Coding</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/speaking">Speaking</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/writing">Writing</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/media">Media</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/now">Now</a>
      </li>
      <li class="menu-item menu-item-type-post_type menu-item-object-page">
        <a href="/about">About me</a>
      </li>
    </ul>
  </nav>
</div>

                        <a class="site-branding" href="/" title="Doctype" rel="home">
                            <span class="logo-container">
                                <img data-at2x src="/images/logo.png" alt="Website's logo">
                            </span>
                        </a>
                    </div>
                </header>


<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article class="post type-post status-publish format-standard has-post-thumbnail hentry category-wordpress tag-version tag-wordpress-2 mix">
         <header class="entry-header">
      	   <h2 class="entry-title">Assembling an Iris Rev4</h2>
         </header>

         <div class="entry-meta">
          <span class="posted-on">
            Published at July 23, 2020
          </span>
          <span class="tags-links">
            
          </span>
        </div>

        <div class="entry-content">
          <p>It&rsquo;s been a while since I&rsquo;m looking for a keyboard that would be great to take
with me when I&rsquo;m not working from home for some days. I finally found the Iris
keyboard that seems to be exactly what I&rsquo;m looking for.</p>
<h2 id="the-need">The need</h2>
<p>I currently have a Kinesis Advantage at home. The keyboard is great, probably
the best keyboard I used so far, but it&rsquo;s far from what we can call portable
ðŸ˜…. I needed a keyboard I could take with me when I wanted, so I started a
quest to find it.</p>
<ul>
<li>I bought a <a href="http://www.typematrix.com/2030/features.php">typematrix keyboard</a>
but it was not good enough (not even mechanical).</li>
<li>I had a <a href="https://deskthority.net/wiki/HHKB_Lite">HHKB Lite</a> but I wanted a
mechanical keyboard (it uses rubber dome).</li>
<li>I bought a
<a href="https://mechanicalkeyboards.com/shop/index.php?l=product_list&amp;c=165">Pok3r</a>
keyboard but it was too heavy for what I wanted.</li>
<li>I bought an <a href="https://atreus.technomancy.us/">Atreus keyboard</a> but found that
a 40% layout was too small for my needs</li>
</ul>
<p>Then I found the <a href="https://keeb.io/products/iris-keyboard-split-ergonomic-keyboard">Iris
keyboard</a>,
which seems to be the perfect size between the Atreus and Kinesis keyboards.
The problem is that it&rsquo;s a DIY keyboard and I had zero experience with anything
electronic.</p>
<p>Talking to some friends I found that the Iris is the easy mode of DIY
keyboards, so I decided to give it a try.</p>
<h2 id="pieces-and-prices">Pieces and prices</h2>
<p>I had to buy the following pieces to be able to do it:</p>
<ul>
<li>1 x <a href="https://www.amazon.com/gp/product/B07S18VCDN/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&amp;psc=1">DSA Keycaps</a>: $23.50</li>
<li>5 x <a href="https://www.amazon.com/gp/product/B01N45BWC3/ref=ppx_yo_dt_b_asin_title_o01_s00?ie=UTF8&amp;psc=1">Cherry MX Clear Keyswitch (10 pack)</a>: $50</li>
<li>1 x <a href="https://keeb.io/products/iris-keyboard-case-plates?variant=7472218210334">Iris Keyboard - Case/Plates</a>: $27.99</li>
<li>1 x <a href="https://keeb.io/products/iris-keyboard-split-ergonomic-keyboard?variant=29480467267678">Iris Keyboard - PCBs for Split Ergonomic Keyboard</a>: $59.99</li>
<li>1 x <a href="https://keeb.io/account/orders/25478d0d3478d5aa26c647de49310efd">TRRS Cable - Black Coiled</a>: $7.98</li>
<li>Shipping costs: $6.10 (keeb.io) + $30 to ship it to Brazil (the final value is R$125 in my local currency)</li>
<li>1 Multimeter: R$37,00</li>
<li>1 Soldering kit (soldering iron, desoldering pump, soldering iron stand, tin wire tube): R$88,00</li>
<li>Acrylic Middle layers: $30.00 (bought after the keyboard was assembled as it&rsquo;s optional)</li>
</ul>
<p>The sum is about $234.60 + R$125,00 (~30 USD). I believe I spend around <strong>280
USD</strong> to build the keyboard. In my local currency, using the current
conversion (it may have been different when I first bought the needed
components), it&rsquo;s around <strong>R$1400,00</strong>.</p>
<h2 id="assembling">Assembling</h2>
<p><img src="/images/posts/iris-rev4/initial.jpg" alt="A laptop, PCB, soldering iron, keycaps, and switches on the table" title="Ready to start"></p>
<p>Again, I would like to mention that I had 0 experience with anything
electronic, so it was a amazing how noob I was. :)</p>
<p><img src="/images/posts/iris-rev4/first-soldering.jpg" alt="Soldering on a switch pin in the PCB" title="My first soldering, not very good"></p>
<p>This was my first soldering. Not something I&rsquo;m proud of but something I laugh
about today.</p>
<p>A friend of mine recommended me to use a fan to avoid inhaling the melted tin,
so I was doing that. It just took me a while to realize that my fan was
actually cooling the tin and the soldering iron making the whole process harder
to do. If this is your case, be careful with your fan.</p>
<p><img src="/images/posts/iris-rev4/corner-switches.jpg" alt="A PCB with four switches mounted" title="Starting with the four corners"></p>
<p>It&rsquo;s recommended to first do the soldering for the corner switches so it&rsquo;s easy
to change anything in case the position is wrong somehow.</p>
<p><img src="/images/posts/iris-rev4/testing-all-switches.jpg" alt="A laptop, a notebook with a drawing of the keyboard layout, and the PCB connected to the laptop" title="Testing connections with a tweezer"></p>
<p>I first checked if all the connections for the switches were working correcly.
I just used a tweezer to close the connection and get the signal on <code>xev</code>. Keep
in mind that the <code>fn</code> keys do not emit any signal and it doesn&rsquo;t mean it&rsquo;s not
working. ðŸ˜‰</p>
<p><img src="/images/posts/iris-rev4/testing-the-mount.jpg" alt="The PCB with 4 switches mounted. Three brown and one purple" title="Initial mount just to be sure everything is in place"></p>
<p>The four switches were soldered and I did the initia mounting to be sure
everything is in place. I&rsquo;m using brown switches for almost all keys, except
the modifiers where I&rsquo;m using outemu purple switches.</p>
<p>It seems like a planned change but I did that to avoid buying another set of
switches and a friend (thanks rhruiz!) kindly gave me these outemu purple to
complete my set.</p>
<p><img src="/images/posts/iris-rev4/mounting-all-switches.jpg" alt="A PCB with half of the switches already inserted. Most of them are brown but there&rsquo;s also 4 purple" title="Inserting all switches"></p>
<p>It&rsquo;s time to insert all switches.</p>
<p><img src="/images/posts/iris-rev4/soldering-process.jpg" alt="macro picture of the PCB to show the soldering" title="Soldering one by one"></p>
<p>Soldering time! The soldering is not great but it&rsquo;s the best I could do on my first attempt. :)</p>
<p><img src="/images/posts/iris-rev4/all-soldering-done.jpg" alt="A picture of the PCB with all its soldering points" title="Soldering done"></p>
<p>The left side is done!</p>
<p><img src="/images/posts/iris-rev4/testing-on-xev.jpg" alt="The left side of the keyboard turned on with red LED. The laptop in the background running xev on the termimal" title="Testing all switches using xev"></p>
<p>Testing all the switches using <code>xev</code> just to be sure the soldering is working (spoiler: it is!)</p>
<p><img src="/images/posts/iris-rev4/other-side.jpg" alt="The right side PCB upside down right below the completed left part of the keyborad. Laptop in the background" title="Soldering the other side"></p>
<p>It&rsquo;s time to do the soldering on the right side. Same process.</p>
<p><img src="/images/posts/iris-rev4/keycaps.jpg" alt="Both sides of the keyboard side by side and some keycaps already inserted" title="Adding the keycaps"></p>
<p>Now that everything is in place, let&rsquo;s add the keycaps.</p>
<p><img src="/images/posts/iris-rev4/v0-done-fixing-bugs.jpg" alt="The laptop running xev on top, a notebook with a pen to highlight faulty keys on a drawing and the full keyboard running on the side" title="Finished the initial version and testing everything again to find problems"></p>
<p>Here it is! The first version is done! ðŸŽ‰</p>
<p>It&rsquo;s expected that some keys will stop working after adding the keycaps,
especially in my case since my soldering skills are not good.  I went one by
one and found some malfunctioning keys, so it&rsquo;s time to get back to soldering.</p>
<p><img src="/images/posts/iris-rev4/done.jpg" alt="The laptop running Vim with the text &ldquo;DONE!&rdquo; written. The completed keyboard with red LEDs below" title="Problems fixed, all done!"></p>
<p>That&rsquo;s it! Everything done for now and the keyboard is usable already!</p>
<p><em>PS: <a href="https://photos.google.com/share/AF1QipOEfqRQ-V2aVWYO1ENs4xrMADgwfMQM36D0hgdGdv1kW8T04pNHui4JX3UffsHO9A?key=WnJ1YXhNTERaTnhNNFVDQnh2enA3ekd6ZjlTZVN3">Here</a> is the album with all pictures I took while assembling the keyboard.</em> ðŸ˜‰</p>
<h3 id="debugging">Debugging</h3>
<p>At some point I started having some weird behaviors like this &ldquo;heaven and hell&rdquo; LEDs:</p>
<p><img src="/images/posts/iris-rev4/heaven-and-hell.jpg" alt="The laptop mounted on a Roost stand and the keyboard below. One side with right LEDs and the other with blue LEDs" title="It was a nice bug, I actually liked this coloring LOL"></p>
<p>And after some time the keyboard just got disconnected with a yellow LED light:</p>
<p><img src="/images/posts/iris-rev4/yellow-light.jpg" alt="The laptop mounted on a Roost stand and the keyboard below. The keyboard showing an yellow LED color" title="This is a bad color for sure :("></p>
<p>After disconnecting, the keyboad was not responding anymore. No LEDs, no
<code>dmesg</code> message or anything. :(</p>
<p>I used the multimeter to do some basic continuity tests (thanks for the
guidance <a href="https://twitter.com/rhruiz">@rhruiz</a>) but found not short circuit or
anything like that. After some time and a RESET while plugged, the keyboard went
back to life, showing itself again on <code>dmesg</code>.</p>
<p>I saw a <code>dmesg</code> message complaining about the USB cabe and we (me and rhruiz)
have a feeling the max brightness on both sides was too much too handle. ðŸ¤”</p>
<p>After all of that, the keyboard was reborn and baptized as Telperion:</p>
<p><img src="/images/posts/iris-rev4/telperion.jpg" alt="The keyboard with a blue/white LED lighting" title="Welcome back to life, Telperion!"></p>
<p>It&rsquo;s important to keep in mind that DIY keyboard will certainly require some
sort of maintenance from time to time. This is especially true if it&rsquo;s your
first keyboard (as it&rsquo;s mine!) because your soldering may not be the best and
it will require some small resoldering fix after some time.</p>
<h2 id="customizing-the-firmware">Customizing the firmware</h2>
<p>The first thing to do is to clone the <a href="https://github.com/qmk/qmk_firmware/">qmk firmware
repository</a>. I suggest forking it and
cloning your own fork since you will probably change it. ðŸ˜‰</p>
<p>After cloning the repository, you have to install the software needed to
compile and flash the firmware. There are two (maybe more) ways to do that:</p>
<ol>
<li>You can use docker via <code>util/docker_build.sh</code> script. It would be something
like: <code>util/docker_build.sh keebio/iris/rev4:default:flash</code></li>
<li>You can install all the tools locally via <code>util/qmk_install.sh</code> and flash
with <code>make keebio/iris/rev4:default:flash</code></li>
</ol>
<p>I would love to use the option 1 but for some reason docker cannot find the
keyboard via USB and I had to install the tooling locally. I suggest you to
start trying docker and if it didn&rsquo;t work, go for option 2.</p>
<h3 id="compiling-your-own-keymap">Compiling your own keymap</h3>
<p>I <a href="https://github.com/PotHix/qmk_firmware/tree/master/keyboards/keebio/iris/keymaps/pothix">created my own keymap inside my
fork</a>
so it would be easy to keep the main code updated. So I have to use the following command to compile it:</p>
<pre><code>make keebio/iris/rev4:pothix
</code></pre><p>If everything goes right, I just can just flash it.</p>
<p>Connect the keyboard to the USB port and hit the RESET button. It may be via
RESET button at the back of the keyboard of actually hitting the RESET key on
the &ldquo;LOWER&rdquo; layer (check the default keymap for more info).</p>
<p>After that, run the following command:</p>
<pre><code>sudo make keebio/iris/rev4:pothix:flash
</code></pre><p>I&rsquo;m not able to flash it without sudo, so keep it in mind when flashing.</p>
<p>Remember to flash both sides because you may get incompatibilities and weird
behaviors sometimes. Here is one I had:</p>
<p><img src="/images/posts/iris-rev4/flash-both-sides.jpg" alt="The keyboard with a blue/white LEDs on the left side and a red+blue on the right side. The right side seems to be malfunctioning." title="The right side is totally messed up!"></p>
<h3 id="optimizing">Optimizing</h3>
<p>Depending on what you&rsquo;re using on your keyboard, you may exceed the maximum
size for the binary. If this is the case for you (as it was for me :P), you can
start disabling features you&rsquo;re not using.</p>
<p><a href="https://thomasbaart.nl/2018/12/01/reducing-firmware-size-in-qmk/">This
article</a> was
very helpful for me to understand what can be done. If you want some examples,
check my
<a href="https://github.com/PotHix/qmk_firmware/blob/master/keyboards/keebio/iris/keymaps/pothix/rules.mk">rules.mk</a>
and
<a href="https://github.com/PotHix/qmk_firmware/blob/master/keyboards/keebio/iris/keymaps/pothix/config.h">config.h</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>It&rsquo;s not cheaper to build your own keyboard as one would expect, but it&rsquo;s
definitely fun if you want to get your hands dirty with soldering to build
something custom for yourself. I learned a lot in the process and I hope to be
able to maybe build another keyboard in the future.</p>
<p>It will probably not be the last keyboard I will build. I still want to build a
<a href="https://github.com/mjohns/dactyl-cc">dactyl-cc</a> at some point to take the
place of my current Kinesis Advantage. It&rsquo;s a handwired keyboard, so I will
have to move to the hard version of keyboard assembling. :)</p>
<p>Happy keyboard building! âŒ¨</p>

          
<div id="disqus_thread"></div>
<script type="text/javascript">
     
    var disqus_shortname = 'pothixcom';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


        </div>
      </article>
    </main>
  </div>
</div>

        <footer class="footer-widget-area">
            <div class="inside">
                <div class="grids">
                    <aside id="stag-dribbble-2" class="widget grid-4 stag-dribbble">
                        <div>
                            <h3 class="widget-title">
                                <span>Photography, a hobby</span>
                            </h3>
                            <a href="https://500px.com/pothix">
                                <img src="https://drscdn.500px.org/photo/306645053/q%3D80_h%3D600/v2?sig=f0145e764e9dead0b4a6500b9fb53591aeb72f18eadb26bbd6c345322144abbf" style="float:left">
                            </a>
                            <div class="textwidget">
                                <center>Check out <a href="https://500px.com/pothix">my 500px account</a> for more photos!</center>
                            </div>
                        </div>
                    </aside>

                    <aside id="recent-posts-2" class="widget grid-4 widget_recent_entries">
                        <h3 class="widget-title">
                            <span>Last 3 books read</span>
                        </h3>

                        <ul>
                            <style type="text/css" media="screen">
                                .gr_grid_container {
                                 
                                    height:150px;
                                }

                                .gr_grid_book_container {
                                    float: left;
                                    width: 98px;
                                    height: 160px;
                                    padding: 0px 0px;
                                    overflow: hidden;
                                }
                            </style>

                            <div id="gr_grid_widget_1490660444">
                            </div>

                            <script src="https://www.goodreads.com/review/grid_widget/38970458.Willian's%20bookshelf:%20read?cover_size=medium&hide_link=true&hide_title=true&num_books=3&order=d&shelf=read&sort=date_read&widget_id=1494295777
" type="text/javascript" charset="utf-8"></script>
                        </ul>
                    </aside>

                    <aside id="text-2" class="widget grid-4 widget_text">
                        <h3 class="widget-title">
                            <span>Follow this blog</span>
                        </h3>
                        <div class="textwidget">
                            I've added three different RSS feeds here based on categories. The idea was to help you the tech guy that don't want to see what kind of motorcycle I have, or the english speaker that don't want to see portuguese posts on his feed reader.
                            <br /><br />
                            So, I have a feed for <a href="http://feeds.feedburner.com/PotHix">all my posts</a>, for the <a href="http://feeds.feedburner.com/EnglishPotHix">English posts</a> and <a href="http://feeds.feedburner.com/PotHixTech">Tech related posts</a>. Choose one and be happy! :)
                        </div>
                    </aside>
                </div>
            </div>
        </footer>

        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="site-info">
                <div class="grids">
                    <div class="grid-6">
                        Â© 2020 <a href="http://demo.codestag.com/doctype/">Doctype</a> WordPress Theme by <a href="//codestag.com">Codestag</a> modified by PotHix.
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script type='text/javascript' src='/javascripts/jquery.js'></script>
    <script type='text/javascript' src='/javascripts/widget.min.js'></script>
    <script type='text/javascript' src='/javascripts/tabs.min.js'></script>
    <script type='text/javascript' src='/javascripts/jquery.custom.js'></script>
    <script type='text/javascript' src='/javascripts/plugins.js'></script>
    <script type='text/javascript' src='/javascripts/jquery.mixitup.min.js'></script>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-2852094-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

</body>
</html>

